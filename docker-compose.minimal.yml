services:
  # Приложение
  arbitrage-scanner:
    build: .
    container_name: arbitrage-app
    depends_on:
      - fluent-bit
    environment:
      - LOGS_FB_HOSTS=fluent-bit
      - LOGS_FB_PORT=24224
      - SERVICE_NAME=arbitrage-scanner
    ports:
      - "8080:8080"

  # Fluent Bit для сбора stdout логов
  fluent-bit:
    image: fluent/fluent-bit:3.0
    container_name: fluent-bit
    ports:
      - "24224:24224"
      - "2020:2020"
    volumes:
      - ./config/fluent-bit/fluent-bit.conf:/fluent-bit/etc/fluent-bit.conf
    command: ["/fluent-bit/bin/fluent-bit", "--config=/fluent-bit/etc/fluent-bit.conf"]